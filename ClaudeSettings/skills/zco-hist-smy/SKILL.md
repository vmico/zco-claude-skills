---
name: zco-hist-smy
description: 汇总 _.zco_hist 目录下的对话历史记录，生成摘要报告。支持按日期范围筛选，输出到 AICO_DOCS 目录。
allowed-tools: Bash, Read, Glob, Write
---

# 对话历史汇总

## 🎯 Skill 用途

自动汇总 `_.zco_hist/` 目录下的 Claude Code 对话记录，生成结构化的摘要报告。

**核心功能**：
- **按日期筛选**：支持指定天数范围（当天、近7天、全部）
- **自动汇总**：统计对话数量、工具使用情况、高频主题
- **生成报告**：输出到 `AICO_DOCS` 目录，便于归档和分享

---

## 📋 何时使用此 Skill

- **每日总结**：回顾当天的工作内容
- **周报生成**：汇总一周的对话记录
- **历史归档**：整理和备份历史对话

---

## 📥 参数说明

**命令格式**：
```bash
zco-hist-smy [-d days]
```

**参数**：
| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `-d` | 整数 | 1 | 天数范围 |

**参数取值**：
- `-d 1` - 当天（默认）
- `-d 7` - 近 7 天（从今天往前推 7 天）
- `-d 0` - 不限日期（所有历史记录）

**示例**：
```bash
zco-hist-smy        # 汇总当天
zco-hist-smy -d 1   # 汇总当天（显式）
zco-hist-smy -d 7   # 汇总近 7 天
zco-hist-smy -d 0   # 汇总所有历史记录
```

---

## 🚀 执行流程

### Step 1: 解析参数

提取用户指定的天数参数，默认为 1（当天）。

### Step 2: 计算日期范围

根据参数计算起始日期：
- `-d 1`: 起始日期 = 今天
- `-d 7`: 起始日期 = 今天 - 7 天
- `-d 0`: 起始日期 = 无限制（所有历史）

### Step 3: 扫描对话文件

在 `_.zco_hist/` 目录下查找符合条件的 Markdown 文件：
- 文件名模式：`*.md`
- 修改时间/文件名日期在指定范围内

### Step 4: 解析内容

读取每个对话文件，提取：
- 对话标题/主题
- 使用的工具（Read/Write/Edit/Bash/Task 等）
- 参考资源（文件路径、URLs）
- 时间信息

### Step 5: 生成汇总

统计信息：
- 总对话数
- 各工具使用次数
- 高频主题词
- 涉及的项目文件

### Step 6: 输出报告

生成 Markdown 格式的汇总报告，保存到 `AICO_DOCS/zco_hist_smy_{日期}.md`

---

## 📄 输出格式

**文件名**：`zco_hist_smy_YYYYMMDD.md`

**内容结构**：
```markdown
# 对话历史汇总报告

**生成时间**: 2026-02-12 10:30:00
**统计周期**: 2026-02-05 至 2026-02-12 (7天)
**总对话数**: 15

---

## 📊 统计概览

| 指标 | 数值 |
|------|------|
| 总对话数 | 15 |
| 使用工具次数 | 42 |
| 涉及文件数 | 8 |
| 访问 URLs | 3 |

### 工具使用分布

| 工具 | 次数 | 占比 |
|------|------|------|
| Read | 20 | 47.6% |
| Edit | 12 | 28.6% |
| Bash | 6 | 14.3% |
| Task | 4 | 9.5% |

---

## 📝 对话列表

### 1. cli_style_250212_103000.md
- **时间**: 2026-02-12 10:30:00
- **主题**: API 接口开发
- **工具**: Read × 3, Edit × 2
- **涉及文件**: `routers/api.py`, `models/user.py`

### 2. ...

---

## 📁 涉及文件汇总

- `routers/api.py`
- `models/user.py`
- `config/settings.py`

---

## 🔗 参考资源汇总

- 📄 `/path/to/README.md`
- 🌐 `https://example.com/docs`

---

*生成于 2026-02-12 10:30:00*
```

---

## ⚙️ 环境变量

| 变量 | 默认值 | 说明 |
|------|--------|------|
| `AICO_DOCS` | `.` | 输出目录，默认为当前目录 |

---

## 🐛 故障排查

### 找不到 _.zco_hist 目录

确保在项目根目录执行，或 `_.zco_hist/` 目录存在。

### 没有输出文件

检查日期范围内是否有对话记录：
```bash
ls -la _.zco_hist/*.md
```

### AICO_DOCS 目录不存在

脚本会自动创建目录，或手动创建：
```bash
mkdir -p AICO_DOCS
```
